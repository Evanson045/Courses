{% extends "base.html" %}
{% block title %}{{ module.title }}{% endblock %}
{% block content %}
<div class="container mt-5">
  <div class="module-section p-4">
    <h2 class="fw-bold text-center">{{ module.title }}</h2>
    <hr>
    <p class="module-description text-white text-center">{{ module.description }}</p>
    {% if module.content %}
      <div class="module-content mt-3">
        {{ module.content|safe }}
      </div>
    {% endif %}
  </div>
</div>

<!-- Navigation buttons -->
<div class="mt-4 d-flex justify-content-between align-items-center">
  <!-- Back to Course always visible -->
  <a href="{{ url_for('course_detail', course_name=course_name) }}" class="btn btn-secondary">
    ← Back to Course
  </a>

  <div class="ms-auto">
    {% if module.id > 1 %}
      <!-- Previous module -->
      <a href="{{ url_for('module', course_name=course_name, id=module.id - 1) }}" class="btn btn-outline-light me-2">
        ← Previous
      </a>
    {% endif %}
    {% if module.id < course.modules|length %}
      <!-- Next module -->
      <a href="{{ url_for('module', course_name=course_name, id=module.id + 1) }}" class="btn btn-outline-light">
        Next →
      </a>
    {% endif %}
  </div>
</div>

{% if not user.is_subscribed and module.id > 5 %}
<!-- PayPal Unlock Modal -->
<div class="modal fade" id="paypalUnlockModal" tabindex="-1" aria-labelledby="paypalUnlockModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content shadow-lg">
      <div class="modal-header">
        <h5 class="modal-title" id="paypalUnlockModalLabel">Unlock Module</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body text-center">
        <p>To unlock this module, please pay <strong>KES 500</strong> via PayPal.</p>
        <!-- PayPal Hosted Button -->
        <div id="paypal-container-25ZB5B5M2Z9F8"></div>
      </div>
    </div>
  </div>
</div>

<!-- Trigger Button -->
<div class="container mt-3">
  <button class="btn btn-warning w-100" data-bs-toggle="modal" data-bs-target="#paypalUnlockModal">
    Unlock Module
  </button>
</div>

<!-- PayPal SDK Script -->
<script src="https://www.paypal.com/sdk/js?client-id=AUvxeWZl_Jhm4R0bJ4AAE5RcEE8074-jcEHw81Vd4qMncGa5ABA15ZPHCrSHRfZkzohWmq0nrKljNrqv&currency=USD"></script>
<script>
  paypal.HostedButtons({
    hostedButtonId: "25ZB5B5M2Z9F8" // your hosted button ID for single module
  }).render("#paypal-container-25ZB5B5M2Z9F8");
</script>
{% endif %}
{% endblock %}
